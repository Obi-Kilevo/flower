<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Face Route</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .preview-container {
            max-width: 300px;
            max-height: 200px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .img-preview {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .example-box {
            background: #f8f9fa;
            border-left: 4px solid #0a4d2b;
            padding: 10px 15px;
            margin-top: 5px;
            border-radius: 4px;
        }
    </style>
</head>

<body>
<div class="container mt-4">

    <h2>‚úèÔ∏è Edit Face Route</h2>

    <form th:action="@{/faceroute/admin/update/{id}(id=${route.id})}"
          th:object="${route}"
          method="post">

        <!-- BASIC INFO -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">üõ£Ô∏è Basic Route Information</h5>
            </div>
            <div class="card-body">
                <div class="row g-3">

                    <div class="col-md-6">
                        <label class="form-label">Park Name *</label>
                        <input type="text" class="form-control" th:field="*{parkName}" required>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Route Name *</label>
                        <input type="text" class="form-control" th:field="*{routeName}" required>
                    </div>

                    <div class="col-12">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" th:field="*{description}" rows="3"></textarea>
                    </div>

                </div>
            </div>
        </div>

        <!-- ROUTE DETAILS -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">üìä Route Details</h5>
            </div>
            <div class="card-body">
                <div class="row g-3">

                    <div class="col-md-4">
                        <label class="form-label">Price</label>
                        <input type="number" step="0.01" class="form-control" th:field="*{price}">
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Show Price</label>
                        <select class="form-select" th:field="*{showPrice}">
                            <option th:value="true">Yes</option>
                            <option th:value="false">No</option>
                        </select>
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Status</label>
                        <input type="text" class="form-control" th:field="*{status}">
                    </div>

                </div>
            </div>
        </div>

        <!-- IMAGE & FORM PATH SECTION -->
        <div class="card mb-4">
            <div class="card-header bg-warning text-white">
                <h5 class="mb-0">üñºÔ∏è Route Image & Form Path</h5>
            </div>
            <div class="card-body">

                <!-- Image URL -->
                <div class="mb-3">
                    <label class="form-label fw-bold">Image URL</label>
                    <input type="text"
                           class="form-control"
                           th:field="*{imageUrl}"
                           id="imageUrlInput"
                           placeholder="https://example.com/image.jpg">

                    <div th:if="${route.imageUrl}" class="mt-2 small text-muted">
                        <a th:href="${route.imageUrl}" target="_blank" th:text="${route.imageUrl}"></a>
                    </div>

                    <div class="example-box">
                        <strong>üí° Example:</strong><br>
                        <code>https://images.pexels.com/photo-road.jpg</code>
                    </div>
                </div>

                <!-- Form Path -->
                <div class="mb-3">
                    <label class="form-label fw-bold">Form Path</label>
                    <input type="text"
                           class="form-control"
                           th:field="*{formPath}"
                           placeholder="/booking/form/path">
                    <div class="example-box">
                        <strong>üí° Example:</strong><br>
                        <code>/booking/adventure/safari</code>
                    </div>
                </div>

                <!-- Image Preview -->
                <div class="mb-3">
                    <label class="form-label fw-bold">Image Preview</label>
                    <div class="preview-container" id="imagePreview">
                        <div th:if="${route.imageUrl}">
                            <img th:src="${route.imageUrl}" class="img-preview">
                        </div>
                        <div th:unless="${route.imageUrl}" class="text-muted text-center">
                            <div style="font-size: 3rem;">üõ£Ô∏è</div>
                            <div>No image provided</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- DESCRIPTION DETAILS -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">üß≠ Route Description Details</h5>
            </div>
            <div class="card-body">
                <div class="row g-3">

                    <div class="col-md-4">
                        <label class="form-label">Adventure Type</label>
                        <input type="text" class="form-control" th:field="*{descAdventureType}">
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Duration</label>
                        <input type="text" class="form-control" th:field="*{descDuration}">
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Meals</label>
                        <input type="text" class="form-control" th:field="*{descMeals}">
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Accommodation</label>
                        <input type="text" class="form-control" th:field="*{descAccommodation}">
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Activities</label>
                        <input type="text" class="form-control" th:field="*{descActivities}">
                    </div>

                    <div class="col-md-4">
                        <label class="form-label">Transport</label>
                        <input type="text" class="form-control" th:field="*{descTransport}">
                    </div>

                </div>
            </div>
        </div>

        <!-- TIMESTAMPS -->
        <div class="card mb-4">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">üìÖ Timestamps</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <strong>Created:</strong>
                        <span th:text="${#temporals.format(route.createdAt,'yyyy-MM-dd HH:mm')}"></span>
                    </div>
                    <div class="col-md-6">
                        <strong>Last Updated:</strong>
                        <span th:text="${#temporals.format(route.updatedAt,'yyyy-MM-dd HH:mm')}"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIONS -->
        <div class="mb-3">
            <button type="submit" class="btn btn-primary">Update Route</button>
            <a th:href="@{/faceroute/admin}" class="btn btn-secondary">Cancel</a>
        </div>

    </form>
</div>

<script>
    const input = document.getElementById("imageUrlInput");
    const preview = document.getElementById("imagePreview");

    input.addEventListener("input", function () {
        const url = this.value;
        if (!url) {
            preview.innerHTML = `
                <div class="text-muted text-center">
                    <div style="font-size: 3rem;">üõ£Ô∏è</div>
                    <div>No image provided</div>
                </div>`;
            return;
        }

        preview.innerHTML = `
            <div class="text-center">
                <div class="spinner-border spinner-border-sm"></div>
                <div class="small">Loading preview...</div>
            </div>`;

        const img = new Image();
        img.onload = () => preview.innerHTML = `<img src="${url}" class="img-preview">`;
        img.onerror = () => preview.innerHTML = `
            <div class="text-danger text-center">
                <div style="font-size: 2rem;">‚ö†Ô∏è</div>
                <div>Cannot load image</div>
            </div>`;
        img.src = url;
    });
</script>

</body>
</html>