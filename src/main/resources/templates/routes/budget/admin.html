<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Budget Routes Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
      padding-top: 20px;
    }
    .header {
      background-color: #e74c3c;
      color: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }
    .route-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      background-color: white;
    }
    .status-available {
      color: #28a745;
      font-weight: bold;
    }
    .status-unavailable {
      color: #dc3545;
      font-weight: bold;
    }
    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    .nav-back {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
<div class="container">
  <!-- Header -->
  <div class="header">
    <h1>üõ§Ô∏è Budget Routes Management</h1>
    <p class="mb-0">Admin Control Panel for Budget Routes</p>
  </div>

  <!-- Add New Route Form -->
  <div class="card mb-4">
    <div class="card-header bg-danger text-white">
      <h5 class="mb-0">‚ûï Add New Budget Route</h5>
    </div>
    <div class="card-body">
      <form th:action="@{/broutes/admin}" th:object="${newRoute}" method="post">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Park Name</label>
            <input type="text" class="form-control" th:field="*{parkName}" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">Route Name</label>
            <input type="text" class="form-control" th:field="*{routeName}" required>
          </div>
          <div class="col-12">
            <label class="form-label">Description</label>
            <textarea class="form-control" th:field="*{description}" rows="2" required></textarea>
          </div>
          <div class="col-md-4">
            <label class="form-label">Price ($)</label>
            <input type="number" class="form-control" th:field="*{price}" step="0.01">
          </div>
          <div class="col-md-4">
            <label class="form-label">Show Price?</label>
            <select class="form-select" th:field="*{showPrice}">
              <option value="true">Yes</option>
              <option value="false">No</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">Status</label>
            <select class="form-select" th:field="*{status}">
              <option value="available">Available</option>
              <option value="unavailable">Unavailable</option>
            </select>
          </div>

          <div class="col-12">
            <label class="form-label">Adventure Type</label>
            <input type="text" class="form-control" th:field="*{descAdventureType}"
                   placeholder="e.g., Budget Tour, Backpacking">
          </div>

          <div class="col-md-6">
            <label class="form-label">Duration</label>
            <input type="text" class="form-control" th:field="*{descDuration}"
                   placeholder="e.g., 2 Days / 1 Night">
          </div>

          <div class="col-md-6">
            <label class="form-label">Meals</label>
            <input type="text" class="form-control" th:field="*{descMeals}"
                   placeholder="e.g., Self-catering">
          </div>

          <div class="col-md-6">
            <label class="form-label">Accommodation</label>
            <input type="text" class="form-control" th:field="*{descAccommodation}"
                   placeholder="e.g., Hostels, Camping">
          </div>

          <div class="col-md-6">
            <label class="form-label">Activities</label>
            <input type="text" class="form-control" th:field="*{descActivities}"
                   placeholder="e.g., Self-guided Hiking">
          </div>

          <div class="col-md-6">
            <label class="form-label">Form Path</label>
            <input type="text" class="form-control" th:field="*{formPath}" required>
          </div>

          <div class="col-12">
            <label class="form-label">Transport</label>
            <input type="text" class="form-control" th:field="*{descTransport}"
                   placeholder="e.g., Public Transport">
          </div>

          <div class="col-12">
            <div class="card">
              <div class="card-header bg-info text-white">
                <h6 class="mb-0">üñºÔ∏è Route Image (Optional)</h6>
              </div>
              <div class="card-body">
                <div class="mb-3">
                  <label class="form-label">Image URL or Path</label>
                  <input type="text" class="form-control" th:field="*{imageUrl}"
                         placeholder="Enter direct URL or static path">
                </div>
              </div>
            </div>
          </div>

          <div class="col-12">
            <button type="submit" class="btn btn-danger">Add Route</button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- List of Existing Routes -->
  <h2 class="mb-3">üìã Existing Budget Routes</h2>

  <div th:if="${#lists.isEmpty(routes)}" class="alert alert-info">
    No budget routes found. Add your first route above!
  </div>

  <div th:each="route : ${routes}" class="route-card">
    <div class="row">
      <div class="col-md-8">
        <h4 th:text="${route.routeName}">Route Name</h4>
        <p class="text-muted mb-2">
          <strong>Park:</strong> <span th:text="${route.parkName}">Park Name</span>
        </p>
        <p th:text="${route.description} ?: 'No description provided.'">Description</p>

        <div th:if="${route.formPath}" class="mb-2">
          <strong>Form Path:</strong>
          <code th:text="${route.formPath}"></code>
        </div>

        <div class="d-flex gap-3">
          <span><strong>Price:</strong>
            <span th:if="${route.price != null}">$<span th:text="${#numbers.formatDecimal(route.price, 1, 2)}">0.00</span></span>
            <span th:if="${route.price == null}">Not set</span>
          </span>
          <span><strong>Show Price:</strong> <span th:text="${route.showPrice ? 'Yes' : 'No'}">Yes/No</span></span>
          <span><strong>Status:</strong>
            <span th:class="${route.status == 'available' ? 'status-available' : 'status-unavailable'}"
                  th:text="${route.status}">Status</span>
          </span>
        </div>
        <div th:if="${route.imageUrl}" class="mt-2">
          <small><strong>Image URL:</strong> <a th:href="${route.imageUrl}" target="_blank" th:text="${route.imageUrl}"></a></small>
        </div>
      </div>

      <div class="col-md-4">
        <div class="action-buttons">
          <a th:href="@{/broutes/admin/edit/{id}(id=${route.id})}"
             class="btn btn-warning btn-sm">‚úèÔ∏è Edit</a>

          <form th:action="@{/broutes/admin/delete/{id}(id=${route.id})}"
                method="post"
                onsubmit="return confirm('Delete this route?');">
            <button type="submit" class="btn btn-danger btn-sm">üóëÔ∏è Delete</button>
          </form>

          <form th:action="@{/broutes/admin/toggle/{id}(id=${route.id})}"
                method="post"
                style="display: inline;">
            <button type="submit"
                    class="btn btn-sm"
                    th:class="${route.status == 'available' ? 'btn btn-secondary btn-sm' : 'btn btn-success btn-sm'}"
                    th:text="${route.status == 'available' ? 'Mark Unavailable' : 'Mark Available'}">
              Toggle Status
            </button>
          </form>
        </div>

        <div class="mt-2 text-muted small">
          <div th:if="${route.createdAt}">
            Created: <span th:text="${#temporals.format(route.createdAt, 'yyyy-MM-dd HH:mm')}">Date</span>
          </div>
          <div th:if="${route.updatedAt}">
            Updated: <span th:text="${#temporals.format(route.updatedAt, 'yyyy-MM-dd HH:mm')}">Date</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>